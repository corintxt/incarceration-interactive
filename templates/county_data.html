{% extends "layout.html" %}

{% block content %}

<div class="chart-header text-center">
    <h1>
      State: {{ session.get('current_state') }}
    </h1>
    <h2>
      County: {{ session.get('current_county') }}
    </h2>
  </div>

<div class="chart-container">

  <div class="charts text-center">
    <div class="row"><div id="map"></div></div>
    <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>

  <!-- County info section -->
  <div class="charts text-center">
    <div class="row"><div id="info">
      <h2>Demographics</h2>
      <p>County population (2016): {{ total_population }}</p>
      <p>State population (2016): TKTK. </p>
    </div></div>
  </div>

  <hr>

  <div class="text-center">
      <h2>Prisons vs Jails</h2>
  </div>
  <div class="text-center chart-description">
    <p>First we will provide some introductory information on the difference between
       prisons and jails, because it needs explanation.</p>
  </div>

  <hr>

  <div class="text-center">
      <h2>Prison statistics</h2>
  </div>

  <div id="bar-container">
    <div class="charts text-center">
        <div class="row"><div id="bar"></div></div>
        <div id="vis-tooltip" class="vg-tooltip"></div>

    <div class="text-center chart-description">
      <p>Here is a paragraph with some explanatory text about prison population in <code>{{ session.get('current_county') }}</code>.</p>
      <p>It will make the context clearer for the reader.</p>
      <p>There will be further definitions when we have written them.</p>
    </div>
  </div>

  <div class="charts text-center">
      <div class="row"><div id="scatter"></div></div>
      <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>
  <div class="text-center chart-description">
    <p>The chart above shows the prison population compared to total population
      for each county in <code>{{ session.get('current_state') }}</code>
    </p>
    <p>A null value for total prison population on this chart indicates that the state
      declined to provide the requested information.</p>
  </div>

  <hr>
  
  <div class="text-center">
      <h2>Jail statistics</h2>
  </div>

  <div class="charts text-center">
    <div class="row"><div id="multiline"></div></div>
    <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>

  <div class="charts text-center">
      <div class="row"><div id="pretrial"></div></div>
      <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>

  <hr>

  <div class="charts text-center">
      <div class="row">
        <a href="/select" class="btn btn-secondary" id="view-another" role="button">View another county</a>
      </div>
  </div>


</div>

<!-- Render Charts -->
<script type="text/javascript">

  function parse(url, div) {
    var opt = {
      mode: "vega-lite",
      renderer: "svg",
      actions: {export: true, source: false, editor: false}
    };

    vegaEmbed("#"+div, url, opt, function(error, result) {
      // result.view is the Vega View, url is the original Vega-Lite specification
      vegaTooltip.vegaLite(result.view, url);
  
    });
  }
  
    //tells vega where to find the JSON for each chart type
    parse("/bar", "bar")
    parse("/multiline", "multiline")
    parse("/pretrial", "pretrial")
    parse("/map", "map")
    parse("/scatter", "scatter")

</script>

{% endblock %}