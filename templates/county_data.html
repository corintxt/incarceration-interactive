{% extends "layout.html" %}

{% block content %}

<div class="chart-header text-center">
    <h1>
      State: {{ session.get('current_state') }}
    </h1>
    <h2>
      County: {{ session.get('current_county') }}
    </h2>
  </div>

<div class="chart-container">

  <div class="charts text-center" id="mappin">
    <div class="row"><div id="map"></div></div>
    <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>

  <!-- County info section -->
  <div class="charts text-center">
    <div class="row"><div id="info">
      <h2>Some info will go here.</h2>
      <p>Total population (2016): {{ total_population }}</p>
    </div></div>
  </div>

  <hr>

  <div class="charts text-center">
      <div class="row"><div id="bar"></div></div>
      <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>

  <hr>

  <div class="charts text-center">
    <div class="row"><div id="multiline"></div></div>
    <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>

  <hr>

  <div class="charts text-center">
      <div class="row"><div id="pretrial"></div></div>
      <div id="vis-tooltip" class="vg-tooltip"></div>
  </div>

  <hr>

  <div class="charts text-center">
      <div class="row">
        <a href="/select" class="btn btn-secondary" role="button">View another county</a>
      </div>
  </div>

</div>

<!-- Render Charts -->
<script type="text/javascript">

  function parse(url, div) {
    var opt = {
      mode: "vega-lite",
      renderer: "svg",
      actions: {export: true, source: false, editor: false}
    };

    vegaEmbed("#"+div, url, opt, function(error, result) {
      // result.view is the Vega View, url is the original Vega-Lite specification
      vegaTooltip.vegaLite(result.view, url);
  
    });
  }
  
    //tells vega where to find the JSON for each chart type
    parse("/bar", "bar")
    parse("/multiline", "multiline")
    parse("/pretrial", "pretrial")
    parse("/map", "map")

</script>

{% endblock %}